@using NonFactors.Mvc.Grid
@using HesProject.Models

@model IGrid<ProlizData>

@{
    Layout = "~/Views/Shared/_SecurityLayout.cshtml";
}

<div class="modal fade" id="modalGrup" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="margin-top: 125px">

        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Bilgiler</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i aria-hidden="true" class="ki ki-close"></i>
                </button>
            </div>

            <div class="modal-body">
                <form asp-action="Edit" method="post">
                    <input type="hidden" class="form-control" name="action" value="Employee">

                    <div class="form-group row">
                        <label class="col-2 col-form-label">Tc</label>
                        <div class="col-4">
                            <input type="text" class="form-control" name="Tc" id="Tc">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-2 col-form-label">Hes</label>
                        <div class="col-4">
                            <input type="text" class="form-control" name="Hes" id="Hes">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-2 col-form-label">Status</label>
                        <div class="col-4">
                            <input type="text" class="form-control" name="Status" id="Status">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-2 col-form-label">Durum</label>
                        <div class="col-4">
                            <input type="text" class="form-control" name="Durum" id="Durum">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-4">
                            <button type="submit" class="btn btn-secondary">Kaydet</button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Kapat</button>
            </div>
        </div>

    </div>
</div>

<div class="d-flex flex-column-fluid">
    <!--begin::Container-->
    <div class="container" style="max-width: 100%">
        <!--end::Notice-->
        <!--begin::Card-->
        <div class="card card-custom">
            <div class="card-header flex-wrap border-0 pt-6 pb-0">
                <div class="card-title">
                    <h3 class="card-label">
                        Riskli Kişiler Listesi
                    </h3>
                </div>
                @*<div class="card-toolbar">
                        <a asp-action="" style="background-color: #3699ff; border-color: #3699ff;" class="btn btn-info font-weight-bolder font-size-sm mr-3">Excel</a>
                    </div>*@
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 15-->
                        <a asp-action="Employee" class="card card-custom bg-success bg-hover-state-success card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-success font-weight-bolder font-size-h5 mb-2 mt-5">PERSONEL SAYISI</div>
                                <div class="font-weight-bold text-inverse-success font-size-sm">@ViewBag.Person</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 15-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 15-->
                        <a asp-action="EmployeeRiskless" class="card card-custom bg-success bg-hover-state-success card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-success font-weight-bolder font-size-h5 mb-2 mt-5">SAĞLIKLI PERSONEL SAYISI</div>
                                <div class="font-weight-bold text-inverse-success font-size-sm">@ViewBag.PersonRiskless</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 15-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 13-->
                        <a asp-action="EmployeeRisky" class="card card-custom bg-danger bg-hover-state-danger card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-danger font-weight-bolder font-size-h5 mb-2 mt-5">RİSKLİ PERSONEL SAYISI</div>
                                <div class="font-weight-bold text-inverse-danger font-size-sm">@ViewBag.PersonRisky</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 13-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 14-->
                        <a asp-action="EmployeeError" class="card card-custom bg-primary bg-hover-state-primary card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-primary font-weight-bolder font-size-h5 mb-2 mt-5">KOD HATALI OLAN PERSONEL SAYISI</div>
                                <div class="font-weight-bold text-inverse-primary font-size-sm">@ViewBag.PersonError</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 14-->
                    </div>
                </div>

                <div class="row">
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 15-->
                        <a asp-action="Student" class="card card-custom bg-success bg-hover-state-success card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-success font-weight-bolder font-size-h5 mb-2 mt-5">ÖĞRENCİ SAYISI</div>
                                <div class="font-weight-bold text-inverse-success font-size-sm">@ViewBag.Student</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 15-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 15-->
                        <a asp-action="StudentRiskless" class="card card-custom bg-success bg-hover-state-success card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-success font-weight-bolder font-size-h5 mb-2 mt-5">SAĞLIKLI ÖĞRENCİ SAYISI</div>
                                <div class="font-weight-bold text-inverse-success font-size-sm">@ViewBag.StudentRiskless</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 15-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 13-->
                        <a asp-action="StudentRisky" class="card card-custom bg-danger bg-hover-state-danger card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-danger font-weight-bolder font-size-h5 mb-2 mt-5">RİSKLİ ÖĞRENCİ SAYISI</div>
                                <div class="font-weight-bold text-inverse-danger font-size-sm">@ViewBag.StudentRisky</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 13-->
                    </div>
                    <div class="col-xl-3">
                        <!--begin::Stats Widget 14-->
                        <a asp-action="StudentError" class="card card-custom bg-primary bg-hover-state-primary card-stretch gutter-b">
                            <!--begin::Body-->
                            <div class="card-body">
                                <div class="text-inverse-primary font-weight-bolder font-size-h5 mb-2 mt-5">KOD HATALI OLAN ÖĞRENCİ SAYISI</div>
                                <div class="font-weight-bold text-inverse-primary font-size-sm">@ViewBag.StudentError</div>
                            </div>
                            <!--end::Body-->
                        </a>
                        <!--end::Stats Widget 14-->
                    </div>
                </div>
                <!--begin: Search Form-->
                <!--begin::Search Form-->
                <!--end::Search Form-->
                <!--end: Search Form-->
                <!--begin: Datatable-->
                @(new HtmlGrid<ProlizData>
   (Html, Model)
    .Build(columns =>
    {

    })
    .Empty("No data found")
    .Filterable()
    .Sortable()
    .Pageable()
    .Attributed(new {id="StudentTable" })

    )
                <!--end: Datatable-->
            </div>
        </div>
        <!--end::Card-->
    </div>
    <!--end::Container-->
</div>


@section scripts

{


    <script>

        var rowData;
        $("#StudentTable").on("click", "a.detay", function (e) {

            var ID = e.currentTarget.dataset["aday"];
            $.ajax({
                async: false,
                method: "GET",
                dataType: "json",
                url: "hes/security/getData",
                data: { ID: ID }
            }).done(function (resp) {
                rowData = resp;
                console.log(rowData);
                
                document.getElementById("name").innerHTML = rowData.ad;
                document.getElementById("surname").innerHTML = rowData.soyad;
                document.getElementById("employeeType").innerHTML = rowData.tip;
                document.getElementById("title").innerHTML = rowData.departman; document.getElementById("phoneNumber").innerHTML = rowData.phone; document.getElementById("emailAddress").innerHTML = rowData.email;
                if (rowData.current_health_status == "RISKLESS") {
                    document.getElementById("healty").innerHTML = "RİSKLİ DEĞİL";
                }
                else if (rowData.current_health_status == "RISKY") {
                    document.getElementById("healty").innerHTML = "RİSKLİ";
                }
                else {
                    document.getElementById("healty").innerHTML = "Bilgi Bulunamadı";
                }

                if (rowData.is_vaccinated == true) {
                    document.getElementById("vaccine").innerHTML = "Aşıları Tamamlanmıştır";
                }
                else if (rowData.is_vaccinated == false) {
                    document.getElementById("vaccine").innerHTML = "Aşıları Tamamlanmamıştır";
                }
                else {
                    document.getElementById("vaccine").innerHTML = "Bilgi Bulunamadı";
                }

                if (rowData.is_immune == true) {
                    document.getElementById("immune").innerHTML = "Hastalık Geçirmiştir";
                }
                else if (rowData.is_immune == false) {
                    document.getElementById("immune").innerHTML = "Hastalık Geçirmemiştir";
                }
                else {
                    document.getElementById("immune").innerHTML = "Bilgi Bulunamadı";
                }

                if (rowData.last_negative_test_date != null) {
                    document.getElementById("pcr").innerHTML = rowData.last_negative_test_date;
                }
                else {
                    document.getElementById("pcr").innerHTML = "Bilgi Bulunamadı";
                }

            })
        });


    </script>

}